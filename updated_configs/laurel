{
  "description" : "laurel",
  "processors" : [
    { "set":          { "if": "ctx.host?.name != null",   "field": "observer.name", "value": "{{host.name}}", "override": true } },
    { "set":          { "field": "event.module", "value": "laurel", "override": true } },
    { "rename":       { "field": "SYSCALL.SYSCALL", "target_field": "auditd.data.syscall",  "ignore_missing": true  } },
    { "set":          { "if": "ctx.USER_ACCT?.msg != null",   "field": "event.dataset", "value": "user_acct_pam", "override": true } },
    { "set":          { "if": "ctx.auditd?.data?.syscall != null",   "field": "event.dataset", "value": "{{auditd.data.syscall}}", "override": true } },
    { "join":         { "if": "ctx.PROCTITLE?.ARGV != null", "field": "PROCTITLE.ARGV", "separator": ","  } },
    { "gsub":         { "if": "ctx.PROCTITLE?.ARGV != null", "field": "PROCTITLE.ARGV", "pattern": "\\,", "replacement": " "  } },
    { "set":          { "if": "ctx.PROCTITLE?.ARGV != null", "field": "process.command_line",  "value": "{{PROCTITLE.ARGV}}", "override": true } },
    { "join":         { "if": "ctx.EXECVE?.ARGV != null", "field": "EXECVE.ARGV", "separator": ","  } },
    { "gsub":         { "if": "ctx.EXECVE?.ARGV != null", "field": "EXECVE.ARGV", "pattern": "\\,", "replacement": " "  } },
    { "set":          { "if": "ctx.EXECVE?.ARGV != null", "field": "process.command_line",  "value": "{{EXECVE.ARGV}}", "override": true } }, 
    { "set":          { "if": "ctx.event?.dataset != null && ctx.event.dataset.contains('connect')", "field": "event.dataset", "value": "network_connection", "override": true }  },
    { "set":          { "if": "ctx.event?.dataset != null && ctx.event.dataset.contains('execve')", "field": "event.dataset", "value": "process_creation", "override": true }  },
    { "set":          { "if": "ctx.SYSCALL?.success != null && ctx.SYSCALL.success.contains('yes')", "field": "auditd.result", "value": "success", "override": true }  },
    { "rename":       { "field": "SYSCALL.tty", "target_field": "auditd.data.tty",  "ignore_missing": true  } },
    { "rename":       { "field": "PROCTITLE.ARGV || EXECVE.ARGV", "target_field": "process.command_line",  "ignore_missing": true  } },
    { "rename":       { "field": "SYSCALL.AUID", "target_field": "auditd.summary.actor.primary",  "ignore_missing": true  } },
    { "rename":       { "field": "SYSCALL.ARCH", "target_field": "auditd.data.arch",  "ignore_missing": true  } },
    { "rename":       { "field": "SYSCALL.GID", "target_field": "group.name",  "ignore_missing": true  } },
    { "rename":       { "field": "SYSCALL.SGID", "target_field": "set.group.name",  "ignore_missing": true  } },
    { "rename":       { "field": "SYSCALL.EGID", "target_field": "user.effective.group.name",  "ignore_missing": true  } },
    { "rename":       { "field": "SYSCALL.SUID", "target_field": "set.user.name",  "ignore_missing": true  } },
    { "rename":       { "field": "SYSCALL.FSUID", "target_field": "user.filesystem.name",  "ignore_missing": true  } },
    { "rename":       { "field": "SYSCALL.FSGID", "target_field": "user.filesystem.group.name",  "ignore_missing": true  } },
    { "rename":       { "field": "SYSCALL.EUID", "target_field": "user.effective.name",  "ignore_missing": true  } },
    { "rename":       { "field": "SYSCALL.egid", "target_field": "user.effective.group.id",  "ignore_missing": true  } },
    { "rename":       { "field": "SYSCALL.euid", "target_field": "user.effective.id",  "ignore_missing": true  } },
    { "rename":       { "field": "SYSCALL.SUID", "target_field": "user.saved.name",  "ignore_missing": true  } },
    { "rename":       { "field": "SYSCALL.UID", "target_field": "user.name",  "ignore_missing": true  } },
    { "rename":       { "field": "SYSCALL.comm", "target_field": "process.name",  "ignore_missing": true  } },
    { "rename":       { "field": "SYSCALL.fsuid", "target_field": "user.filesystem.id",  "ignore_missing": true  } },
    { "rename":       { "field": "SYSCALL.uid", "target_field": "user.id",  "ignore_missing": true  } },
    { "rename":       { "field": "SYSCALL.suid", "target_field": "user.saved.id",  "ignore_missing": true  } },
    { "rename":       { "field": "SYSCALL.sgid", "target_field": "user.saved.group.id",  "ignore_missing": true  } },
    { "rename":       { "field": "SYSCALL.exit", "target_field": "auditd.data.exit",  "ignore_missing": true  } },
    { "rename":       { "field": "SYSCALL.gid", "target_field": "user.group.id",  "ignore_missing": true  } },
    { "rename":       { "field": "SYSCALL.fsgid", "target_field": "user.filesystem.group.id",  "ignore_missing": true  } },
    { "rename":       { "field": "SYSCALL.exe", "target_field": "process.executable",  "ignore_missing": true  } },
    { "rename":       { "field": "PARENT_INFO.comm", "target_field": "process.parent.command_line",  "ignore_missing": true  } },
    { "rename":       { "field": "PARENT_INFO.exe", "target_field": "process.parent.executable",  "ignore_missing": true  } },
    { "rename":       { "field": "SYSCALL.ppid", "target_field": "process.ppid",  "ignore_missing": true  } },
    { "rename":       { "field": "SYSCALL.pid", "target_field": "process.pid",  "ignore_missing": true  } },
    { "community_id": {} }
  ]
}

